
WITH raw_data AS (
    SELECT
        incident_number,
        exposure_number,
        id,
        address,
        city,
        zipcode,
        battalion,
        station_area,
        box,
        supervisor_district,
        neighborhood_district,
        point,
        CAST(incident_date AS DATE) AS incident_date,
        call_number,
        alarm_dttm AS raw_alarm_dttm,
        CAST(alarm_dttm AS TIMESTAMP) AS alarm_dttm,
        CAST(arrival_dttm AS TIMESTAMP) AS arrival_dttm,
        CAST(close_dttm AS TIMESTAMP) AS close_dttm,
        first_unit_on_scene,
        number_of_alarms,
        primary_situation,
        mutual_aid,
        suppression_units,
        suppression_personnel,
        ems_units,
        ems_personnel,
        other_units,
        other_personnel,
        estimated_property_loss,
        estimated_contents_loss,
        fire_fatalities,
        fire_injuries,
        civilian_fatalities,
        civilian_injuries,
        action_taken_primary,
        action_taken_secondary,
        action_taken_other,
        detector_alerted_occupants,
        property_use,
        area_of_fire_origin,
        ignition_cause,
        ignition_factor_primary,
        ignition_factor_secondary,
        heat_source,
        item_first_ignited,
        human_factors_associated_with_ignition,
        structure_type,
        structure_status,
        floor_of_fire_origin,
        fire_spread,
        no_flame_spread,
        number_of_floors_with_minimum_damage,
        number_of_floors_with_significant_damage,
        number_of_floors_with_heavy_damage,
        number_of_floors_with_extreme_damage,
        detectors_present,
        detector_type,
        detector_operation,
        detector_effectiveness,
        detector_failure_reason,
        automatic_extinguishing_system_present,
        automatic_extinguishing_sytem_type,
        automatic_extinguishing_sytem_perfomance,
        automatic_extinguishing_sytem_failure_reason,
        number_of_sprinkler_heads_operating,
        data_as_of,
        data_loaded_at
    FROM {{ source('raw_data', 'RAW_DATA') }}
)

SELECT
    incident_number,
    exposure_number,
    id,
    address,
    city,
    zipcode,
    battalion,
    station_area,
    box,
    supervisor_district,
    neighborhood_district,
    point,
    raw_incident_date AS incident_date_raw,
    incident_date,
    call_number,
    alarm_dttm,
    arrival_dttm,
    close_dttm,
    first_unit_on_scene,
    number_of_alarms,
    primary_situation,
    mutual_aid,
    suppression_units,
    suppression_personnel,
    ems_units,
    ems_personnel,
    other_units,
    other_personnel,
    estimated_property_loss,
    estimated_contents_loss,
    fire_fatalities,
    fire_injuries,
    civilian_fatalities,
    civilian_injuries,
    action_taken_primary,
    action_taken_secondary,
    action_taken_other,
    detector_alerted_occupants,
    property_use,
    area_of_fire_origin,
    ignition_cause,
    ignition_factor_primary,
    ignition_factor_secondary,
    heat_source,
    item_first_ignited,
    human_factors_associated_with_ignition,
    structure_type,
    structure_status,
    floor_of_fire_origin,
    fire_spread,
    no_flame_spread,
    number_of_floors_with_minimum_damage,
    number_of_floors_with_significant_damage,
    number_of_floors_with_heavy_damage,
    number_of_floors_with_extreme_damage,
    detectors_present,
    detector_type,
    detector_operation,
    detector_effectiveness,
    detector_failure_reason,
    automatic_extinguishing_system_present,
    automatic_extinguishing_sytem_type,
    automatic_extinguishing_sytem_perfomance,
    automatic_extinguishing_sytem_failure_reason,
    number_of_sprinkler_heads_operating,
    data_as_of,
    data_loaded_at
FROM raw_data;
